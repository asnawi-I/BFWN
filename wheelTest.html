<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Color Wheel Spinner</title>
    <style>
        @import url("https://fonts.googleapis.com/css2?family=Fredoka+One:wght@400&family=Alegreya+Sans+SC:wght@400;900&display=swap");
        
        :root {
          --font-main: "Alegreya Sans SC", sans-serif;
          --font-fun: "Fredoka One", cursive;
          --color-bg: #000b14;
          --color-theme: #EE786E;
          --color-accent: #FFD700;
        }
        
        * {
          box-sizing: border-box;
          margin: 0;
          padding: 0;
        }
        
        body {
          height: 100vh;
          background: radial-gradient(circle at center, #001122 0%, var(--color-bg) 100%);
          color: var(--color-theme);
          font-family: var(--font-main);
          overflow: hidden;
        }
        
        /* Animated background dots */
        .bg-dots {
          position: fixed;
          width: 100%;
          height: 100%;
          pointer-events: none;
          z-index: -1;
        }
        
        .bg-dot {
          position: absolute;
          width: 3px;
          height: 3px;
          background: var(--color-theme);
          border-radius: 50%;
          opacity: 0.3;
          animation: float 6s infinite ease-in-out;
        }
        
        @keyframes float {
          0%, 100% { transform: translateY(0px) rotate(0deg); opacity: 0.3; }
          50% { transform: translateY(-20px) rotate(180deg); opacity: 0.8; }
        }
        
        h1 {
          position: absolute;
          top: 2rem;
          left: 50%;
          transform: translateX(-50%);
          font-size: 4rem;
          font-family: var(--font-fun);
          text-shadow: 0 0 20px currentColor;
          transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
          z-index: 10;
        }
        
        h1.isHidden {
          opacity: 0;
          visibility: hidden;
          transform: translateX(-50%) translateY(-2rem) scale(0.5);
        }
        
        .wheel-container {
          position: absolute;
          left: 50%;
          bottom: -35%;
          transform: translateX(-50%);
          width: 80vmin;
          height: 80vmin;
        }
        
        svg#wheel {
          width: 100%;
          height: 100%;
          filter: drop-shadow(0 0 30px rgba(255, 215, 0, 0.3));
        }
        
        svg#pin {
          position: absolute;
          left: 50%;
          transform: translateX(-50%) rotate(90deg);
          width: 6%;
          height: 6%;
          fill: var(--color-theme);
          filter: drop-shadow(0 0 10px currentColor);
          z-index: 5;
        }
        
        .spin-button {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 100px;
  height: 100px;
  font-size: 1.2rem;
  font-family: var(--font-fun);
  color: #000;
  background: #FFD700;
  border: 3px solid #000;
  border-radius: 50px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 20;
  outline: none;
  min-width: 100px;
  min-height: 100px;
  max-width: 100px;
  max-height: 100px;
}

.spin-button:hover {
  background: #FFF200;
}

.spin-button:active {
  background: #E6C200;
}

.spin-button.isSpinning {
  cursor: not-allowed;
  background: #CCC;
}
        
        @keyframes buttonSpin {
          0%, 100% { transform: translate(-50%, -50%) rotate(0deg); }
          25% { transform: translate(-50%, -50%) rotate(5deg); }
          75% { transform: translate(-50%, -50%) rotate(-5deg); }
        }
        
        @keyframes pinWheel {
          0%, 100% { transform: translateX(-50%) rotate(90deg); }
          25% { transform: translateX(-50%) rotate(75deg); }
          75% { transform: translateX(-50%) rotate(105deg); }
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
          .wheel-container {
            width: 95vmin;
            height: 95vmin;
          }
          
          h1 {
            font-size: 2.5rem;
          }
          
          .spin-button {
            padding: 1.2rem 2.4rem;
            font-size: 1.6rem;
          }
        }
    </style>
</head>
<body>
    <!-- Animated background dots -->
    <div class="bg-dots"></div>
    
    <div class="wheel-container">
        <svg id="wheel" viewBox="0 0 100 100">
            <circle cx="50" cy="50" r="48" fill="none" stroke-width="1" stroke="currentColor" opacity="0.3"/>
            <circle id="slice" cx="50" cy="50" r="47" fill="#001C34" />
            <g id="slices"></g>
            <!-- Center circle for visual appeal -->
            <circle cx="50" cy="50" r="12" fill="var(--color-bg)" stroke="currentColor" stroke-width="2"/>
            <circle cx="50" cy="50" r="8" fill="currentColor"/>
        </svg>
        
        <button class="spin-button">SPIN!</button>
        
        <svg id="pin" viewBox="0 0 50 50">
            <path d="M 45 25 L 5 10 L 5 40 Z" />
            <circle cx="5" cy="25" r="3" fill="currentColor"/>
        </svg>
    </div>
    
    <h1 class="isHidden">#FFFFFF</h1>

    <script>
        // Create animated background dots
        function createBackgroundDots() {
            const bgDots = document.querySelector('.bg-dots');
            for (let i = 0; i < 20; i++) {
                const dot = document.createElement('div');
                dot.className = 'bg-dot';
                dot.style.left = Math.random() * 100 + '%';
                dot.style.top = Math.random() * 100 + '%';
                dot.style.animationDelay = Math.random() * 6 + 's';
                bgDots.appendChild(dot);
            }
        }
        createBackgroundDots();

        const containerSlices = document.querySelector('g#slices');
        const pin = document.querySelector('svg#pin');
        const heading = document.querySelector('h1');
        const spinButton = document.querySelector('.spin-button');

        let timeoutID = 0;
        let isSpinning = false;

        // Enhanced utility functions
        const randomInt = (min = 0, max = 16) => Math.floor(Math.random() * (max - min) + min);
        const randomHex = () => randomInt().toString(16);

        // The "suspicious" rigged colors - wheel always lands on one of these
        const suspicious = [
            { rotation: 45, color: 'A2CCB6', name: 'Mint Dream' },
            { rotation: 180, color: 'FCEEB5', name: 'Golden Hour' },
            { rotation: 315, color: 'EE786E', name: 'Coral Sunset' }
        ];

        // Add decorative dots around the wheel
        for (let i = 0; i < 48; i += 1) {
            const angle = (360 / 48) * i;
            const transform = `rotate(${angle}) translate(0 -49.5) rotate(${-angle})`;
            const dot = `<circle r="0.8" cx="50" cy="50" fill="currentColor" transform="${transform}" opacity="0.6"/>`;
            containerSlices.innerHTML += dot;
        }

        // Set random background color
        let randomFill = '';
        for (let i = 0; i < 6; i += 1) {
            randomFill += randomHex();
        }
        document.querySelector('svg circle#slice').style.fill = `#${randomFill}`;

        // Create colorful wheel slices
        for (let i = 360; i > 0; i -= 15) {
            const xCoor = 50 + Math.sin(i * Math.PI / 180) * 47;
            const yCoor = 50 - Math.cos(i * Math.PI / 180) * 47;
            const flags = i > 180 ? '0 1 1' : '0 0 1';

            let fill = '';
            for (let j = 0; j < 6; j += 1) {
                fill += randomHex();
            }

            const suspect = suspicious.find(pairing => pairing.rotation === i);
            if (suspect) {
                fill = suspect.color;
            }

            const path = `
                <path d="M 50 50 L 50 3 A 47 47 ${flags} ${xCoor} ${yCoor}" 
                      fill="#${fill}" 
                      stroke="rgba(255,255,255,0.1)" 
                      stroke-width="0.5"/>
            `;
            containerSlices.innerHTML += path;
        }

        function spinWheel() {
            if (isSpinning) return;
            
            isSpinning = true;
            
            // Remove event listeners and add spinning classes
            [spinButton, pin].forEach(el => {
                el.removeEventListener('click', spinWheel);
                el.classList.add('isSpinning');
            });

            heading.classList.add('isHidden');

            // Random spin parameters
            const randomDuration = randomInt(3, 6);
            const randomRotate = randomInt(8, 15);
            const randomSuspect = randomInt(0, 3);
            const selectedColor = suspicious[randomSuspect];

            // Apply enhanced spinning animation
            containerSlices.style.transformOrigin = '50%';
            containerSlices.style.transition = `transform ${randomDuration}s cubic-bezier(0.25, 0.46, 0.45, 0.94)`;
            containerSlices.style.transform = `rotate(${randomRotate * 360 - selectedColor.rotation + 90 + randomInt(0, 360 / 24)}deg)`;

            // Animate the pin
            pin.style.animation = `pinWheel ${randomDuration / 8}s infinite ease-in-out`;

            // Update theme color gradually during spin
            let colorStep = 0;
            const colorInterval = setInterval(() => {
                const randomColor = `#${randomHex()}${randomHex()}${randomHex()}${randomHex()}${randomHex()}${randomHex()}`;
                document.documentElement.style.setProperty('--color-theme', randomColor);
                colorStep++;
                if (colorStep > 20) clearInterval(colorInterval);
            }, randomDuration * 1000 / 20);

            timeoutID = setTimeout(() => {
                // Show final result
                heading.textContent = `#${selectedColor.color}`;
                heading.classList.remove('isHidden');
                
                // Stop animations
                pin.style.animation = '';
                
                // Set final theme color
                document.documentElement.style.setProperty('--color-theme', `#${selectedColor.color}`);

                // Remove spinning classes and restore event listeners
                [spinButton, pin].forEach(el => {
                    el.classList.remove('isSpinning');
                    el.addEventListener('click', spinWheel);
                });

                isSpinning = false;
                clearTimeout(timeoutID);
            }, randomDuration * 1000);
        }

        // Add event listeners
        [spinButton, pin].forEach(el => {
            el.addEventListener('click', spinWheel);
        });

        // Keyboard support
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space' || e.code === 'Enter') {
                e.preventDefault();
                spinWheel();
            }
        });
    </script>
</body>
</html>